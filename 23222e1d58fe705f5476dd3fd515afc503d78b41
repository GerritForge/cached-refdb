{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "258a3319_b44f1f7b",
        "filename": "src/main/java/com/gerritforge/gerrit/plugins/cachedrefdb/RefByNameCacheImpl.java",
        "patchSetId": 14
      },
      "lineNbr": 54,
      "author": {
        "id": 1012541
      },
      "writtenOn": "2026-02-02T15:49:17Z",
      "side": 1,
      "message": "The value of `refs_names_by_project` cache (`ObjectId`) is not used at the moment.\nWe could use `Ref` instead and merge the two caches.\n\n__Pros__:\n- Single cache to maintain (no need to keep in sync between them)\n- No side effects in `RefsByProjectLoader` cache loader (L#106)\n- No explicit cache update in `*RefUpdateWithCacheUpdate` (see for example L#175 of `BatchRefUpdateWithCacheUpdate`)\n\n__Cons__:\n- `refs_names_by_project` has a less granular key (`project-refName` Vs `project`). This might lead to higher concurrency on the keys.\n\nWe could decrese the contention by creating a compound key for `refs_names_by_project` like `project-knownPrefix`, i.e.: `foo$refs/heads`, `foo$refs/tags`, but this might be premature.\n\nWDYT?",
      "range": {
        "startLine": 48,
        "startChar": 0,
        "endLine": 54,
        "endChar": 47
      },
      "revId": "23222e1d58fe705f5476dd3fd515afc503d78b41",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f277fbe6_f99edad0",
        "filename": "src/main/java/com/gerritforge/gerrit/plugins/cachedrefdb/RefByNameCacheImpl.java",
        "patchSetId": 14
      },
      "lineNbr": 194,
      "author": {
        "id": 1020677
      },
      "writtenOn": "2026-02-02T16:23:41Z",
      "side": 1,
      "message": "this makes me think we\u0027re updating the refByName cache, but really its the refsNamesByProject one, no?",
      "range": {
        "startLine": 194,
        "startChar": 14,
        "endLine": 194,
        "endChar": 29
      },
      "revId": "23222e1d58fe705f5476dd3fd515afc503d78b41",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "03a8669d_d0f12f6a",
        "filename": "src/main/java/com/gerritforge/gerrit/plugins/cachedrefdb/RefByNameCacheImpl.java",
        "patchSetId": 14
      },
      "lineNbr": 197,
      "author": {
        "id": 1020677
      },
      "writtenOn": "2026-02-02T16:23:41Z",
      "side": 1,
      "message": "Is throwing an NPE just because the objectId for the ref is null the correct thing to do here?",
      "range": {
        "startLine": 197,
        "startChar": 0,
        "endLine": 197,
        "endChar": 22
      },
      "revId": "23222e1d58fe705f5476dd3fd515afc503d78b41",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bfcd574b_120e973d",
        "filename": "src/main/java/com/gerritforge/gerrit/plugins/cachedrefdb/RefUpdateWithCacheUpdate.java",
        "patchSetId": 14
      },
      "lineNbr": 231,
      "author": {
        "id": 1020677
      },
      "writtenOn": "2026-02-02T16:23:41Z",
      "side": 1,
      "message": "why are we evicting from one cache and adding into the other?",
      "range": {
        "startLine": 230,
        "startChar": 6,
        "endLine": 231,
        "endChar": 82
      },
      "revId": "23222e1d58fe705f5476dd3fd515afc503d78b41",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}